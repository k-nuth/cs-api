<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Target Name="GetBitprimNodeCint">
    <Exec Command="conan remote list" ConsoleToMSBuild="true">
      <Output TaskParameter="ConsoleOutput" PropertyName="ConanRemoteList" />
    </Exec>
    <Exec Command="conan remote update bitprim https://api.bintray.com/conan/k-nuth/kth" Condition="$(ConanRemoteList.Contains('bitprim'))" />
    <Exec Command="conan remote add kth https://api.bintray.com/conan/k-nuth/kth" Condition="!$(ConanRemoteList.Contains('bitprim'))" />
    
    <Message Text="Conan Channel: stable"/>
    <Message Text="Conan Version: 0.19.0"/>
    <Message Text="Conan Currency: BCH"/>
    <Message Text="Conan Keoken: False"/>
    
    <WriteLinesToFile
      File="conanfile.txt" Lines="[requires];kth-node-cint/0.19.0@kth/stable;[generators];cmake;[options];kth-node-cint:shared=True;kth-node-cint:currency=BCH;kth-node-cint:keoken=False;kth-node-cint:db=full;[imports];bin, *.dll    -> .;lib, *.so    -> .;lib, *.dylib    -> ."
      Overwrite="true"/>

    <Message Text="Operating System: $(OS)"/>
    <Exec Command="conan install . --install-folder=. -r bitprim" Condition=" '$(OS)' != 'Windows_NT' " />
    <Exec Command="conan install . --install-folder=. -r bitprim -s compiler=&quot;Visual Studio&quot; -s compiler.version=15" Condition=" '$(OS)' == 'Windows_NT' "/>
    <Message Text="OS = $(OS)" />
    <Copy SourceFiles="kth-node-cint.dll" DestinationFiles="$(OutDir)libkth-node-cint.dll" Condition=" '$(OS)' == 'Windows_NT' "/>
    <Copy SourceFiles="libkth-node-cint.so" DestinationFiles="$(OutDir)libkth-node-cint.so" Condition="Exists('libkth-node-cint.so')"/>
    <Copy SourceFiles="libkth-node-cint.dylib" DestinationFiles="$(OutDir)libkth-node-cint.dylib" Condition="Exists('libkth-node-cint.dylib')"/>
  </Target>
</Project>